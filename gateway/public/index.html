<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Insurance Claims – Demo Client</title>
  <style>
    body{font-family:system-ui;margin:24px;max-width:980px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    input,select,button,textarea{padding:10px;border:1px solid #ddd;border-radius:10px}
    input,select,textarea{flex:1;min-width:240px}
    button{cursor:pointer}
    pre{background:#0b1020;color:#e7e7ff;padding:14px;border-radius:14px;overflow:auto}
    .card{border:1px solid #eee;border-radius:16px;padding:16px;margin-top:14px}
  </style>
</head>
<body>
  <h1>Insurance Claims – Demo Client (REST + SOAP + GraphQL + gRPC)</h1>

  <div class="card">
    <div class="row">
      <input id="customerId" placeholder="customerId" value="CUST-001">
      <input id="fullName" placeholder="fullName" value="Yahya Farehan">
    </div>
    <div class="row" style="margin-top:10px">
      <input id="policyNumber" placeholder="policyNumber" value="POL-123">
      <select id="claimType">
        <option>car</option><option>health</option><option>home</option>
      </select>
      <input id="amount" placeholder="amount" value="1200" type="number">
    </div>
    <div class="row" style="margin-top:10px">
      <textarea id="description" placeholder="description" rows="3">Accident, rear bumper damaged</textarea>
    </div>

    <div class="row" style="margin-top:12px">
      <button onclick="call('/api/rest/claim', buildPayload())">Test REST</button>
      <button onclick="call('/api/soap/verify', pickSoap())">Test SOAP</button>
      <button onclick="call('/api/graphql/policy', pickGraphql())">Test GraphQL</button>
      <button onclick="call('/api/grpc/fraud', pickGrpc())">Test gRPC</button>
      <button onclick="call('/api/process', buildPayload())"><b>RUN ALL</b></button>
    </div>
  </div>

  <div class="card">
    <h3>Result</h3>
    <pre id="out">{}</pre>
  </div>

  <script>
    const out = document.getElementById('out');

    function buildPayload(){
      return {
        customerId: v('customerId'),
        fullName: v('fullName'),
        policyNumber: v('policyNumber'),
        claimType: v('claimType'),
        amount: Number(v('amount')),
        description: v('description')
      }
    }
    function pickSoap(){
      const p = buildPayload();
      return { customerId: p.customerId, fullName: p.fullName, policyNumber: p.policyNumber };
    }
    function pickGraphql(){
      const p = buildPayload();
      return {
        query: `query Validate($policyNumber:String!,$claimType:String!){
          validatePolicy(policyNumber:$policyNumber, claimType:$claimType){ valid covered message }
        }`,
        variables: { policyNumber: p.policyNumber, claimType: p.claimType }
      };
    }
    function pickGrpc(){
      const p = buildPayload();
      return { claimId: "TEMP-CLAIM", amount: p.amount };
    }
    function v(id){ return document.getElementById(id).value; }

    async function call(url, body){
      out.textContent = "Loading...";
      try{
        const r = await fetch(url, {method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify(body)});
        const j = await r.json().catch(()=>({}));
        out.textContent = JSON.stringify({ status:r.status, ...j }, null, 2);
      }catch(e){
        out.textContent = String(e);
      }
    }
  </script>
</body>
</html>
